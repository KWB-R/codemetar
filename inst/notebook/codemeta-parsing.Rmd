---
title: "Parsing codemeta data"
output: github_document
---


```{r message=FALSE}
library(jsonld)
library(magrittr)
```

```{r}
write_codemeta("codemetar", "codemeta.json")
```



Digest input with a frame:

```{r}
frame <- system.file("schema/frame_schema.json", package="codemetar")

meta <- 
  jsonld_frame("codemeta.json", frame) %>%
  jsonld_compact(fromJSON(framed, FALSE)$`@context`) %>%
 fromJSON(FALSE)
```

Construct a citation

```{r}
authors <- 
lapply(meta$author, 
       function(author) 
         person(given = author$given, 
                family = author$family, 
                email = author$email,
                role = "aut"))
year <- meta$datePublished
if(is.null(year)) 
  year <- format(Sys.Date(), "%Y")
bibitem <- 
 bibentry(
     bibtype = "Manual",
     title = meta$name,
     author = authors,
     year = year,
     note = paste0("R package version ", meta$version),
     url = meta$URL,
     key = meta$identifier
   )

cat(format(bibitem, "bibtex"))

bibitem
```

Counts: 

- maintainer : number packages maintained
- author : number of packages
- number of authors, author vs contributor 

```{r}
```
